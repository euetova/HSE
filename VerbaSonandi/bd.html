<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>Verba sonandi</title>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.0/css/font-awesome.min.css">

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Material Design Bootstrap -->
    <link href="css/mdb.min.css" rel="stylesheet">

    <!-- Template styles -->
    <link href="css/style_table.css" rel="stylesheet">
    
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-90767668-1', 'auto');
  ga('send', 'pageview');

    </script>

</head>

<body>


    <!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter42305059 = new Ya.Metrika({
                    id:42305059,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true
                });
            } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
            s = d.createElement("script"),
            f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = "https://mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/42305059" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
    
    
     <nav class="navbar navbar-dark navbar-fixed-top scrolling-navbar">

        <!-- Collapse button-->
        <button class="navbar-toggler hidden-sm-up" type="button" data-toggle="collapse" data-target="#collapseEx">
            <i class="fa fa-bars"></i>
        </button>

        <div class="container">
        
     <div class="collapse navbar-toggleable-xs" id="collapseEx">

         <ul class="nav navbar-nav">
                 <a type="button" class="btn btn-sq-xs btn-default" href="#A">A</a>
             <a type="button" class="btn btn-sq-xs btn-default" href="#B">B</a>
            <button type="button" class="btn btn-sq-xs btn-default">C</button>
            <button type="button" class="btn btn-sq-xs btn-default">D</button>
            <button type="button" class="btn btn-sq-xs btn-default">E</button>
            <button type="button" class="btn btn-sq-xs btn-default">F</button>
            <button type="button" class="btn btn-sq-xs btn-default">G</button>
            <button type="button" class="btn btn-sq-xs btn-default">H</button>
            <button type="button" class="btn btn-sq-xs btn-default">I</button>
            <button type="button" class="btn btn-sq-xs btn-default">J</button>
            <button type="button" class="btn btn-sq-xs btn-default">K</button>
            <button type="button" class="btn btn-sq-xs btn-default">L</button>
            <button type="button" class="btn btn-sq-xs btn-default">M</button>
            <button type="button" class="btn btn-sq-xs btn-default">N</button>
            <button type="button" class="btn btn-sq-xs btn-default">O</button>
            <button type="button" class="btn btn-sq-xs btn-default">P</button>
            <button type="button" class="btn btn-sq-xs btn-default">R</button>
            <button type="button" class="btn btn-sq-xs btn-default">S</button>
            <button type="button" class="btn btn-sq-xs btn-default">T</button>
            <button type="button" class="btn btn-sq-xs btn-default">U</button>
            <button type="button" class="btn btn-sq-xs btn-default">V</button>
            <button type="button" class="btn btn-sq-xs btn-default">W</button>
            <button type="button" class="btn btn-sq-xs btn-default">X</button>
            <button type="button" class="btn btn-sq-xs btn-default">Y</button>
            <button type="button" class="btn btn-sq-xs btn-default">Z</button>
         </ul>
        </div>
            </div>
        </nav>
    

    <div class="container">
        <br><br>
        <br><br>
        
    <div class="container flex-center">
        <ul>
            <li><h1 class=""><b>Сводная таблица<br>
                <i>verba sonandi</i> associes aux animaux</b></h1></li>
            <li><a href="#" class="btn btn-default">Telecharger</a></li>
        </ul>
        </div>
        
        
    </div>


    <!--Footer-->
    <footer class="page-footer center-on-small-only mdb-color darken-4">

        <!--Footer Links-->
        <div class="container-fluid">
        </div>
        <!--/.Footer Links-->

    </footer>
    <!--/.Footer-->


    <!-- SCRIPTS -->

    <!-- JQuery -->
    <script type="text/javascript" src="js/jquery-2.2.3.min.js"></script>

    <!-- Bootstrap tooltips -->
    <script type="text/javascript" src="js/tether.min.js"></script>

    <!-- Bootstrap core JavaScript -->
    <script type="text/javascript" src="js/bootstrap.min.js"></script>

    <!-- MDB core JavaScript -->
    <script type="text/javascript" src="js/mdb.min.js"></script>

    <!-- Animations init-->
    <script>
        new WOW().init();
    </script>
    
<script type="text/javascript">

    $(function () {


        function showInfo(title) {
            // todo change name!
            $.get("/zvukimu/details/" + encodeURIComponent(title),
{#            $.get("/details/" + encodeURIComponent(title),#}
                    function (data) {
                        if (!data) return;
                        $("#title").text(data.verb);
                        $("#trans").text(data.trans);
                        var $list = $("#crew").empty();
                        data.dir.forEach(function (dir) {
                            $list.append($("<li>" + dir.ex + " " +dir.trans + "</li>"));
                        });
                        var $list2 = $("#met").empty();
                        data.met.forEach(function (met) {
                            $list2.append($("<li>" + met.ex + " " +met.trans + " " + met.tag + "</li>"));
                        });
                    }, "json");
            return false;
        }
        function search() {
            var s= $("#search");
            var query=s.find("input[name=search]").val();
            var animal=s.find("input[name=animal]").val();
            var lang=s.find("input[name=language]").val();
            var tag=s.find("input[name=tag]").val();
            draw_graph(query, animal, lang, tag);
            // todo change name!
            $.get("/zvukimu/search?q=" + encodeURIComponent(query)+"&a="+ encodeURIComponent(animal)+"&l="+ encodeURIComponent(lang)+"&t="+ encodeURIComponent(tag),
{#            $.get("/search?q=" + encodeURIComponent(query)+"&a="+ encodeURIComponent(animal)+"&l="+ encodeURIComponent(lang)+"&t="+ encodeURIComponent(tag),#}
                    function (data) {
                        var t = $("table#results tbody").empty();
                        if (!data || data.length == 0) return;
                        data.forEach(function (row) {
                            var animals = row.data;
                            $("<tr><td>" + animals.language + "</td><td class='animal'>" + animals.animal + "</td><td>" + animals.animal2 + "</td><td class='verb'>" + animals.verb + "</td><td>" + animals.trans + "</td><td>" + animals.tag + "</td><td class='ex'>" + animals.ex + "</td></tr>").appendTo(t)
                                    .click(function() { showInfo($(this).find("td.verb").text());})
                        });
                        showInfo(data[0].data.verb);
                    }, "json");
            return false;
        }

        $("#search").submit(search);
        search();


        $('#toggle-two').bootstrapToggle({
            on: 'Таблицы',
            off: 'Графы'
            }).change(function() {
       if ($(this).prop('checked')){$( "#upper_tables" ).hide();} else {$( "#upper_tables" ).show( );}
    });
            })
</script>

<script type="text/javascript">
    function dblclick(d) {
  d3.select(this).classed("fixed", d.fixed = false);
}

function dragstart(d) {
  d3.select(this).classed("fixed", d.fixed = true);
}

    function draw_graph(q, a, l, t){
        d3.select("#graph").html("");
    var width = 800, height = 800;

    var force = d3.layout.force()
            .charge(-200).linkDistance(30).size([width, height]);
    var drag = force.drag().on("dragstart", dragstart);
    var svg = d3.select("#graph").append("svg")
            .attr("width", "100%").attr("height", "100%")
            .attr("pointer-events", "all");

{#// todo change name!#}
{#        d3.json("/graph?q=" + encodeURIComponent(q)+"&a="+ encodeURIComponent(a)+"&l="+ encodeURIComponent(l)+"&t="+ encodeURIComponent(t), function(error, graph) {#}
d3.json("/zvukimu/graph?q=" + encodeURIComponent(q)+"&a="+ encodeURIComponent(a)+"&l="+ encodeURIComponent(l)+"&t="+ encodeURIComponent(t), function(error, graph) {
		if (error) return;

        force.nodes(graph.nodes).links(graph.links).start();

        var link = svg.selectAll(".link")
                .data(graph.links).enter()
                .append("line").attr("class", "link");
        var gnodes = svg.selectAll('g.gnode')
             .data(graph.nodes)
             .enter()
             .append('g')
             .classed('gnode', true);

        var node = gnodes.append("circle")
                .attr("class", function (d) { return "node "+d.label })
//                .attr("data-toggle", "tooltip")
                .attr("r", function (d) { return 5 +d.radius })
                //.attr('title', function (d) { return d.name; })
                .on("dblclick", dblclick)
                .call(force.drag)
                .style("fill", function (d) { return d.color });

        // html title attribute
        node.append("title")
                .text(function (d) { return d.name; }).attr('title', function (d) { return d.name; });
        var labels = gnodes.append("text")
            .text(function(d) {
            return '';//d.name;
       })
            .attr("font-family", "sans-serif")
           .attr("font-size", "11px")
           .attr("fill", "black")
         .attr("text-anchor", "middle");

        // force feed algo ticks
        force.on("tick", function() {
            link.attr("x1", function(d) { return d.source.x; })
                    .attr("y1", function(d) { return d.source.y; })
                    .attr("x2", function(d) { return d.target.x; })
                    .attr("y2", function(d) { return d.target.y; });

            gnodes.attr("transform", function(d) {
        return 'translate(' + [d.x, d.y] + ')';
    });
        });
    $('svg circle').tipsy({
        gravity: 'w',
        html: true,
        title: function() {
          var d = this.__data__, c = d.name;
          return c;
        }
      });
 });}



</script>

</body>

</html>